CONSTANTS
    Domains = {"D1", "D2"}
    MaxRequests = 10
    Nil = "Nil"

SPECIFICATION
    Spec

INVARIANTS
    \* 基础类型安全性
    TypeOK
    
    \* ML-DL状态一致性
    MLDLStateConsistency
    
    \* 投票机制安全性
    VoteConsistency
    ElectionSafety
    
    \* 域管理安全性
    MLDomainConsistency
    
    \* CD-Raft核心安全性
    FastReturnSafety
    Consistency
    CDRaftCoreSafety
    
    \* 客户端域安全性（只处理跨域场景）
    ClientDomainSafety
    
    \* 综合主不变式
    MainInvariant

    LogReplicationConsistency
    
    DLCommitConsistency

\* PROPERTIES
\*     \* 进展性：系统最终能产生响应
\*     Progress

\* 对称性优化（两个域可以互换）
\* SYMMETRY
\*     Permutations(Domains)

\* \* 状态空间约束（防止状态爆炸）
\* CONSTRAINT
\*     /\ reqCounter <= MaxRequests
\*     /\ mlTerm <= 3
\*     /\ Cardinality(responses) <= MaxRequests
\*     /\ Cardinality(votes) <= Cardinality(Domains)
\*     /\ Cardinality(mlCommitted) <= MaxRequests

\* \* 死锁检测
\* CHECK_DEADLOCK
\*     FALSE

\* \* 视图缩减（提高性能）
\* VIEW
\*     <<mlState, mlTerm, Len(mlLog), Cardinality(mlCommitted), currentML, 
\*       [d \in Domains |-> dlStates[d]], 
\*       Cardinality(votes), Cardinality(responses), reqCounter>>

\* TLC运行建议参数：
\* tlc -workers 2 -maxSetSize 100000 cdraftv103_fixed.cfg